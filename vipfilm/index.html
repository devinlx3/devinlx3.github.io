<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script type="text/javascript" src="js/jquery-3.2.1.min.js" ></script>
		<script>
			//测试使用的url路径
			var testUrl = "https://lidevin.github.io";
			//"https://lidevin.github.io"
			//同步 通过url获取html内容
			function getHtml(urlPath){
				var htmlData = "";
				$.ajax({
					type:"get",
					url:urlPath,
					async:false,
					success:function(data){
						htmlData = data;
					}
				});
				return htmlData.trim();
			}
		
			//获取所有的url路径
			var filmName;
			function getFilmUrlName(){
				var filmUrl = [];
				var htmltext = getHtml("filmhtml.html");
				//创建一个div对象
				var elem = document.createElement('div');
				elem.innerHTML = htmltext;
				var reg = /<title>(.*)<\/title>/;
				var srcTitle = htmltext.match(reg)[1];
				//得到电视剧名字
				filmName = srcTitle.substr(0, srcTitle.indexOf(" "));
				//获取所有的item
				var itemsdiv = elem.getElementsByClassName("mod_episode")[0].getElementsByTagName("span");
				var count = 0;
				
				for(var i = 0; i < itemsdiv.length; i++){
					var itema = $(itemsdiv[i]).find('a');
					var itemimg =  $(itemsdiv[i]).find('img');
					if(itemimg.attr("alt") != "预告"){
						filmUrl[count] = "http://api.baiyug.cn/vip/index.php?url=https://v.qq.com" + itema.attr("href");
						count++;
					}
				}
				return filmUrl;
			}
			function show(){
				var contextVal = "";
				filmUrl = getFilmUrlName();
				contextVal += '<table><tr><th colspan="5">'+ filmName +'</th></tr><tr>';
				for(var i = 0; i < filmUrl.length; ){
					contextVal += '<td align="center"><a href=" '+ filmUrl[i] +'" target="_blank">'+ (++i) +'</a></td>';
					if(i%5 == 0){
						contextVal += "</tr><tr>";
					}
				}
				contextVal += "</tr></table>"
				$("#context").html(contextVal);
			}
			window.onload = function(){
				show();
			}
			
		</script>
		<style>
			a{
				text-decoration: none;
			}
			table{
				border: 1px solid black;
			}
			td{
				width: 45px;
				height: 35px;
				text-align: center;
			}
			a:hover td{
				background-color: #CCCCCC;
			}
		</style>
	</head>
	<body>
		<div id="context">
			
		</div>
	</body>
</html>
